import _PyPacwar
from typing import List
import helpers

def round_robin_tournament(sequences: List[List[int]]) -> List[int]:
    """
    Run a round-robin tournament where each sequence battles every other sequence.
    Accumulates points for each sequence using the score function.
    
    Args:
        sequences: A list of sequences, where each sequence is a list of 50 integers (0-3)
    
    Returns:
        A list of accumulated scores, one for each sequence in the same order
    """
    n = len(sequences)
    scores = [0] * n
    
    # Battle each sequence against every other sequence
    for i in range(n):
        for j in range(i + 1, n):
            # Battle sequence i against sequence j
            rounds, c1, c2 = _PyPacwar.battle(sequences[i], sequences[j])
            
            # Get scores for this battle
            # c1 is count for sequences[i], c2 is count for sequences[j]
            score1, score2 = helpers.score(rounds, c1, c2)
            
            # Accumulate scores
            scores[i] += score1
            scores[j] += score2
    
    return scores

if __name__ == "__main__":
    genes = [
        "31310001111122123331111311111321111321331301022311",
        "10110001011122222331111111111121112111121131330331",
        "00020030110122213003133113032122122312111133133103",
        "10110300110022203300111111111322032111121333323311",
        "01001000130022323303210212032232232332330300000313",
        "10110010111022113111111111111112311111121323230310",
        "02020000111122223333212213032332232232220111013313",
        "13012000311122323313212212212232232232310110021312",
        "01001000111122223313222212232212232133010013223303",
        "11001000111022023323212212012232232232310121231330",
        "33333333333333333333333333333333333333333333333333",
        "01001002121121223303212212012232232212320031011333",
        "10110010111121213311311111111122121111321130013331",
        "00110010100022003330121111111121321111211310202331",
        "01000100131122223103222212212232032132012123302313",
        "00000000131120233333211112333212332332011131130131",
        "00100000111322323311122111111213111311230331321111",
        "10000003111122320133333333233222232332301133010310",
        "01001000101022223303232212233032232232332130301333",
        "10020000110122220303112211211122311321301331130301",
        "10020000111122203333233212112222111212310110231311",
        "01000000111022222303232212221232232332313010221333",
        "33020000133022223333213232033232232232102130332131",
        "00100003110122200100111111111121221111121331130330",
        "00100000110122223330111111111212322121000333131111",
        "01001000111022223303212212212232232232310011221333",
        "03100001111130033303312121112211222121131122023132",
        "00300000113122020333133333332333222322303110111310",
        "03100030001300013230321121122112131321131133120123",
        "01001000111022223333212212212232232232310311220333",
        "01000001113122200330322233133223223233130100230313",
        "11020000111022023033233212213332232212313313110310",
        "00300000010122230001322333233223223333320313323311",
        "00020000001122220030323321323122123321303100330313",
        "03000000111100203333122211111211221221301131300300",
        "00300000001112200300323333333333333333110103013110",
        "03100200313020100323321121121111312122133103221133",
        "00100000111022200003111111111111122111330330331300",
        "33320000130122203333232232232232232222130130111130",
        "01000000111102203333333233333223223233113103203113",
        "00000010113102200000321333333223223333310313313311",
        "03100030023320200313221121121111222122131121020110",
        "00120000001002200300321321121121321121131130131131",
        "00300000103122203330323333333233333233113103110110",
        "00020000011122200000123323123123123123303313303311",
        "00300000000122203330323333333333233233110103110110",
        "00300000003122200000322333333333333333110103113100",
        "00100000111120203003111111111111121111331330331300",
        "00020000001022220300321321123121321121133300213101",
        "01300000101120200033133323223322232333313333010310",
        "00021000000122200301321321321121321321131133131101",
        "01300000110122003333133323323322322333310113213310",
        "00020000020002200300321321321121321121131133120131",
        "03100000001020200213313121121111212122131121110130",
        "00120000001022200303321321321321321321131131131131",
        "03100000001120203033311121121111212122130331030131",
        "00020000000002200300321321321121321321131133131101",
        "01300000010102003330133323323322122323313313113310",
        "00020000000002200000321321321121321321131133131121",
        "03100000000000003033311121121122321122131133121131",
        "00020000001002200000321321321121321321131133121121",
        "03100000001020200333311121121111212122131121020130",
        "03130000030000003313311121121122222122131130131131",
        "03100000030000003330311121121121322122131131101130",
        "03100000031000003333311121121111322122130130130131",
    ]
    scores = round_robin_tournament(list(map(helpers.str_to_seq, genes)))

    scored_genes = zip(genes, scores)
    scored_genes = sorted(scored_genes, key=(lambda stuff : stuff[1]))

    for gene, s in scored_genes:
        print(f"{gene}: {s}")
    
    print(f"Max Possible: {len(genes) * 20}")